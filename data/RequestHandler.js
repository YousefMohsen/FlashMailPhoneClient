
import axios from 'axios';
const api = "http://yousefmohsen.dk:4000";
/**
 * Hanldes all REST calls made to the server 
 */
class RequestHandler {


    /**
     * @param {String}mail- students email adress
     * @param{String} token - a pushtoken generated by expo
     * @returns error if error. Returns user object in a promise, if no errors
     * TODO: improve error handling
     */
    handleSignIn = async (mail, token) => {//returns axios promise. 
        let endpoint = api + '/student/login' + "/" + mail + "/" + token;
        console.log(endpoint)
        try {

            let response = await axios.get(endpoint);
            return response.data;
        } catch (error) {
            console.log("ERROR", error)
            return null;
        }
    }
    /**
     * Fetches messages from server for a given student
     * @param {String} mail - the students mail address
     * @param {Integer} timeStamp - the current timestamp 
     */
    fetchMessages = async (mail, timestamp) => {//returns axios promise. 

        if (!timestamp) { timestamp = 0 }
        let endpoint = api + '/msg/' + "/" + mail + "/" + timestamp;
        console.log(endpoint)
        try {
            let response = await axios.get(endpoint);
            return response.data;
        } catch (error) {
            console.log("ERROR", error)
            return null;
        }
    }

}

export default new RequestHandler();